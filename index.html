<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ativação de Plano</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;800&display=swap" rel="stylesheet">

    <!-- Meta Pixel Code -->
    <script>
        !function(f,b,e,v,n,t,s)
        {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window, document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
        fbq('init', 'pixel_aqui');
        fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=pixel_aqui&ev=PageView&noscript=1"
    /></noscript>
    <!-- End Meta Pixel Code -->

    <style>
        /* Fallback font style in case the inline style is stripped */
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body style="
    font-family: 'Inter', sans-serif;
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    margin: 0;
    background-color: #111827;
    background-image:
        radial-gradient(at 27% 37%, hsla(215, 98%, 42%, 0.4) 0px, transparent 50%),
        radial-gradient(at 97% 21%, hsla(125, 98%, 42%, 0.2) 0px, transparent 50%),
        radial-gradient(at 52% 99%, hsla(355, 98%, 42%, 0.4) 0px, transparent 50%),
        radial-gradient(at 10% 29%, hsla(256, 96%, 41%, 0.3) 0px, transparent 50%),
        radial-gradient(at 97% 96%, hsla(38, 60%, 74%, 0.2) 0px, transparent 50%),
        radial-gradient(at 33% 50%, hsla(222, 67%, 73%, 0.3) 0px, transparent 50%),
        radial-gradient(at 79% 53%, hsla(343, 68%, 79%, 0.4) 0px, transparent 50%);
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
">

    <!-- Main container -->
    <div class="w-full max-w-md mx-auto p-6 md:p-8 bg-black bg-opacity-70 backdrop-blur-sm rounded-2xl shadow-2xl m-4">

        <!-- Main Title -->
        <h1 class="text-3xl md:text-4xl font-extrabold text-white text-center mb-4 mt-6">
            Obrigado por adquirir o sistema OTT-Plus!
        </h1>

        <!-- Attention Box -->
        <div class="bg-yellow-500 bg-opacity-10 border border-yellow-400 text-yellow-300 p-4 rounded-lg text-center my-6">
            <h2 class="text-xl font-bold text-yellow-300 mb-2">ATENÇÃO</h2>
            <p class="text-sm md:text-base leading-relaxed">
                Salve o nosso número de whatsapp para não perder o nosso contato caso queira renovar o plano ou solicitar suporte.
            </p>
        </div>

        <!-- Promotion Box -->
        <div class="bg-green-500 bg-opacity-10 border border-green-400 text-green-300 p-4 rounded-lg text-center my-6">
             <p class="text-sm md:text-base font-semibold leading-relaxed">
                Você ganha meses <span class="font-bold text-white">100% GRÁTIS</span> ao indicar pessoas a conhecerem a plataforma!
            </p>
        </div>

        <!-- Activation Text -->
        <p class="text-gray-300 text-center text-lg mb-6">
            Para ativar o plano: <span class="font-semibold text-white">basta clicar em confirmar</span>
        </p>

        <!-- Activation Button -->
        <button id="activationButton" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-4 px-6 rounded-lg text-lg transition-all duration-300 ease-in-out transform hover:scale-105 shadow-lg shadow-red-600/30">
            CONFIRMAR E ATIVAR
        </button>

        <!-- Confirmation Message (hidden by default) -->
        <div id="confirmationMessage" class="hidden mt-6 p-4 bg-blue-500 bg-opacity-20 border border-blue-400 text-blue-200 rounded-lg text-center">
            <p class="font-semibold">Plano ativado com sucesso! Redirecionando para o WhatsApp...</p>
        </div>

    </div>

    <script>
        // JavaScript to handle the button click, Meta API call, and redirect.
        const activationButton = document.getElementById('activationButton');
        const confirmationMessage = document.getElementById('confirmationMessage');

        // --- IMPORTANT SECURITY WARNING ---
        // Your Access Token is visible in this client-side code. This is a major security risk.
        // Anyone can view the source of this page and steal your token.
        // It is STRONGLY RECOMMENDED to move the Conversions API call to a secure server-side
        // environment (like Node.js, PHP, or Python) to protect your token.
        const PIXEL_ID = 'pixel_aqui';
        const ACCESS_TOKEN = 'token_qui';

        /**
         * Sends the Purchase event to the Meta Conversions API.
         */
        async function sendConversionApiEvent() {
            const eventId = crypto.randomUUID(); // Generate a unique ID for event deduplication
            const eventData = {
                data: [{
                    event_name: 'Purchase',
                    event_time: Math.floor(Date.now() / 1000),
                    action_source: 'website',
                    event_id: eventId,
                    user_data: {
                        // Meta will automatically use the IP address and User-Agent from the request headers.
                        // For better matching, you should include user data like email (em) or phone (ph) if you have it.
                    },
                    custom_data: {
                        // You can add custom data like value and currency here
                        // value: 99.99,
                        // currency: 'BRL',
                    }
                }],
                // To test your events, generate a test code in your Events Manager and paste it here.
                // test_event_code: 'YOUR_TEST_EVENT_CODE',
                access_token: ACCESS_TOKEN,
            };

            try {
                const response = await fetch(`https://graph.facebook.com/v20.0/${PIXEL_ID}/events`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(eventData),
                });

                const responseData = await response.json();
                if (response.ok) {
                    console.log('Conversion API event sent successfully:', responseData);
                } else {
                    console.error('Error sending Conversion API event:', responseData);
                }
            } catch (error) {
                console.error('Failed to send Conversion API event request:', error);
            }
        }


        activationButton.addEventListener('click', () => {
            // 1. Fire the Meta Pixel event on the browser side.
            fbq('track', 'Purchase');
            console.log('Meta Pixel (browser) Purchase event fired.');

            // 2. Send the event via the server-side Conversions API.
            sendConversionApiEvent();

            // 3. Update the UI to show confirmation.
            activationButton.style.display = 'none';
            confirmationMessage.classList.remove('hidden');

            // 4. Prepare the WhatsApp URL and redirect the user.
            const phoneNumber = 'numero_aqui';
            const message = 'meu codigo de ativacao do plano é 8037847. Por favor ative meu acesso.';
            const whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;

            // Redirect after a short delay to ensure API calls have time to be sent.
            setTimeout(() => {
                window.location.href = whatsappUrl;
            }, 800); // 800ms delay
        });
    </script>

</body>
</html>
